<h2>Travel Information</h2>

<div >
  <form name="$ctrl.travelInfoForm" role="form" novalidate ng-submit="$ctrl.submit()">

    <legend>
      Passport Information
    </legend>

    <div class="row">
      <div class="col-sm-12" dynamic-content="$root.MESSAGES.TripPassport.content | html"></div>
      <div class="form-group col-sm-12" ng-class="{'has-error': $ctrl.validation.showErrors($ctrl.travelInfoForm, 'validPassport') }">
        <label class="control-label block required">Do you have a valid passport?</label>
        <label class="radio-inline">
          <input ng-model="$ctrl.validPassport" type="radio" value="true"  name="validPassport" id="passport-yes" ng-required="true">Yes
        </label>
        <label class="radio-inline">
          <input ng-model="$ctrl.validPassport" type="radio" value="false" name="validPassport" id="passport-no" ng-required="true">No
        </label>
        <ng-messages for="$ctrl.travelInfoForm.validPassport.$error" ng-if="$ctrl.validation.showErrors($ctrl.travelInfoForm, 'validPassport')">
            <span ng-message="required">
              <span dynamic-content="$root.MESSAGES.fieldCanNotBeBlank.content | html"></span>
            </span>
        </ng-messages>
      </div>
      <div class="form-group col-sm-12" ng-show="$ctrl.validPassport === 'false'">
        <label>
          <span dynamic-content="$ctrl.passportInvalidContent() | html"></span>
        </label>
      </div>
    </div>

    <div class="row" ng-if="$ctrl.validPassport === 'true'">
      <div class="form-group col-sm-6" ng-class="{'has-error': $ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportNumber') }">
        <label for="passport-number" class="control-label required">Passport Number</label>
        <input ng-model="$ctrl.person.passportNumber" 
               type="text"
               class="form-control"
               name="passportNumber"
               id="passport-number"
               required
               placeholder="Enter passport number" />
        <ng-messages for="$ctrl.travelInfoForm.passportNumber.$error" ng-if="$ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportNumber')">
                <span ng-message="required">
                  <span dynamic-content="$root.MESSAGES.fieldCanNotBeBlank.content | html"></span>
                </span>
        </ng-messages>
      </div>

      <div class="form-group col-sm-6" ng-class="{'has-error': $ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportExpire') }">
        <label for="passport-expire" class="control-label required">When does your passport expire?</label>
        <span class="input-group datepicker">
            <input ng-model="$ctrl.person.passportExpiration"
                   type="text"
                   class="form-control"
                   name="passportExpire" id="passport-expire"
                   placeholder="mm/dd/yyyy"
                   datepicker-popup="MM/dd/yyyy"
                   is-open='$ctrl.passportExpireDateOpen'
                   show-button-bar='false'
                   max-date={{$ctrl.maxPassportExpireDate}}
                   min-date={{$ctrl.minPassportExpireDate}}
                   init-date=$ctrl.initDate
                   ng-required="true"
                   datepicker-validator
                   required/>
            <span class="input-group-btn">
             <button type="button" class="btn btn-default" ng-click="$ctrl.openPassportExpireDatePicker($event)"><i class="glyphicon glyphicon-calendar"></i></button>
            </span>
          </span>
        <ng-messages for="$ctrl.travelInfoForm.passportExpire.$error"
                     ng-if="$ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportExpire')">
            <span ng-message="required">
               <span dynamic-content="$root.MESSAGES.fieldCanNotBeBlank.content | html"></span>
             </span>
          <span ng-message="invalidDate">
              <span dynamic-content="$root.MESSAGES.invalidData.content | html"></span>
            </span>
          <span ng-message="minDate">
              <span dynamic-content="$root.MESSAGES.invalidData.content | html"></span>
            </span>
        </ng-messages>
      </div>
    </div><!--/row-->

    <div class="row" ng-if="$ctrl.validPassport === 'true'">
      <div class="form-group col-sm-12">
        <span dynamic-content="$root.MESSAGES.TripPassportName.content | html"></span>
        <div class="row">
          <div class="form-group col-sm-6" ng-class="{'has-error': $ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportFirstName') }">
            <label for="passport-firstname" class="control-label required">First Name</label>
            <input ng-model="$ctrl.person.passportFirstname" type="text" class="form-control" name="passportFirstName" id="passport-firstname" required placeholder="Enter first name">
            <ng-messages for="$ctrl.travelInfoForm.passportFirstName.$error" ng-if="$ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportFirstName')">
                  <span ng-message="required">
                    <span dynamic-content="$root.MESSAGES.fieldCanNotBeBlank.content | html"></span>
                  </span>
            </ng-messages>
          </div>
          <div class="form-group col-sm-6">
            <label for="passport-middlename" class="control-label">Middle Name <small class="text-muted">Exactly as printed on your passport</small></label>
            <input ng-model="$ctrl.person.passportMiddlename" type="text" class="form-control" name="passportMiddlename" id="passport-middlename" placeholder="Enter middle name">
          </div>
        </div>
        <div class="row">
          <div class="form-group col-sm-6" ng-class="{'has-error': $ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportLastName') }">
            <label for="passport-lastname" class="control-label required">Last Name</label>
            <input ng-model="$ctrl.person.passportLastname" type="text" class="form-control" name="passportLastName" id="passport-lastname" required placeholder="Enter last name">
            <ng-messages for="$ctrl.travelInfoForm.passportLastName.$error" ng-if="$ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportLastName')">
                  <span ng-message="required">
                    <span dynamic-content="$root.MESSAGES.fieldCanNotBeBlank.content | html"></span>
                  </span>
            </ng-messages>
          </div>
          <div class="form-group col-sm-6" ng-class="{'has-error': $ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportCountry') }">
            <label for="passport-country" class="control-label required">Country of Passport</label>
            <input ng-model="$ctrl.person.passportCountry" type="text" class="form-control" name="passportCountry" id="passport-country" required placeholder="Enter passport country">
            <ng-messages for="$ctrl.travelInfoForm.passportCountry.$error" ng-if="$ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportCountry')">
                  <span ng-message="required">
                    <span dynamic-content="$root.MESSAGES.fieldCanNotBeBlank.content | html"></span>
                  </span>
            </ng-messages>
          </div>
        </div>
      </div>
    </div><!--/row-->

    <div class="row" ng-if="$ctrl.validPassport === 'true'">
      <div class="form-group col-sm-12">
        <div class="row">
          <div class="form-group col-sm-12" ng-class="{'has-error': $ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportVerify') }">
            <div class="checkbox">
              <label>
                <input type="checkbox" value="yes" ng-model="$ctrl.passportVerify"required name="passportVerify">
                <span dynamic-content="$root.MESSAGES.passportInformationCorrectMessage.content | html"></span>
              </label>
            </div>
            <ng-messages for="$ctrl.travelInfoForm.passportVerify.$error" ng-if="$ctrl.validation.showErrors($ctrl.travelInfoForm, 'passportVerify')">
              <span ng-message="required">
                <span> Please verify that the information you entered is correct. </span>
              </span>
            </ng-messages>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12">
        <legend>Frequent Flyer Information</legend>
      </div>
      <div class="form-group col-sm-6" ng-repeat="flyer in $ctrl.frequentFlyers" >
        <label for="{{flyer.atributeId}}">{{flyer.name}}</label>
        <input ng-model="flyer.notes"
               type="text"
               class="form-control"
               id="{{flyer.attributeId}}"
               name="{{flyer.attributeId}}"
               placeholder="Enter {{flyer.name}} frequent flyer number" />
      </div>
    </div>

    <div class="text-right push-half-top">
      <button type="button" class="btn btn-standard btn-block-mobile" ng-click="$ctrl.cancel()">Cancel</button>

      <loading-button
        input-type='submit'
        normal-text='Save'
        loading-text='Saving...'
        loading='$ctrl.processing'
        loading-class='disabled'
        input-classes='btn btn-primary btn-block-mobile'></loading-button>
    </div>
  </form>
</div>
</div><!--/row-->
